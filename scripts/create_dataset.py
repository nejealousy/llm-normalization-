import random
import json
import csv
import os

products_catalog = {
    "Электронасос": {
        "brands": ["Grundfos", "Pedrollo", "Koshin"],
        "models": ["UPS 32-80", "CPm 158", "SEV 50"],
        "attributes": {
            "Вид продукции": "Электронасос",
            "Мощность, Вт": ["200", "300", "400"],
            "Макс. давление, бар": ["6", "8", "10"]
        }
    },
    "Электроинструмент": {
        "brands": ["Bosch", "Makita", "DeWalt"],
        "models": ["GBH 2-26", "DHP484", "DWE575"],
        "attributes": {
            "Вид продукции": "Электроинструмент",
            "Тип": ["Перфоратор", "Дрель", "Шуруповерт"],
            "Мощность, Вт": ["600", "800", "1000"]
        }
    },
    "Электрощит": {
        "brands": ["Schneider", "ABB", "Legrand"],
        "models": ["ЩРН-24", "ЩРВ-12", "ЩМП-36"],
        "attributes": {
            "Вид продукции": "Электрощит",
            "Количество модулей": ["12", "24", "36"],
            "Материал": ["Металл", "Пластик"]
        }
    },
    "Этикетка": {
        "brands": ["OEM"],
        "models": ["Самоклеящаяся", "Термоусадочная"],
        "attributes": {
            "Вид продукции": "Этикетка",
            "Размер, мм": ["50x30", "100x50"],
            "Материал": ["Бумага", "Пленка"]
        }
    },
    "Юбка защитная": {
        "brands": ["SafePro", "OEM"],
        "models": ["Короткая", "Длинная"],
        "attributes": {
            "Вид продукции": "Юбка защитная",
            "Материал": ["Ткань", "Нетканый материал"],
            "Размер": ["S", "M", "L"]
        }
    },
    "Ящик инструментальный": {
        "brands": ["Stanley", "Keter", "OEM"],
        "models": ["24\"", "18\"", "16\""],
        "attributes": {
            "Вид продукции": "Ящик инструментальный",
            "Материал": ["Пластик", "Металл"],
            "Количество отделений": ["1", "2", "3"]
        }
    },
    "Аккумулятор": {
        "brands": ["Tumen", "Bosch", "Yuasa"],
        "models": ["11В 2,2А/ч", "12В 26А/ч", "12В 7А/ч"],
        "attributes": {
            "Вид продукции": "Аккумулятор",
            "Напряжение, В": ["11", "12"],
            "Емкость, А/ч": ["2.2", "7", "26"]
        }
    },
    "Антифриз": {
        "brands": ["LUKOIL", "Sakura", "Castrol"],
        "models": ["G11-40 RED", "G-12/-40", "SAE 5W-30"],
        "attributes": {
            "Вид продукции": "Антифриз",
            "Цвет": ["Красный", "Зеленый", "Синий"],
            "Объем, л": ["3", "5"]
        }
    },
    "Балансир": {
        "brands": ["УАЗ", "ГАЗ"],
        "models": ["71-2946011-10", "34040", "Правый передний"],
        "attributes": {
            "Вид продукции": "Балансир",
            "Тип": ["Передний", "Средний", "Первого катка"]
        }
    },
    "Бензин": {
        "brands": ["Shell", "Лукойл", "Газпромнефть"],
        "models": ["Регуляр-92", "АИ-95", "Премиум-98"],
        "attributes": {
            "Вид продукции": "Бензин",
            "Октановое число": ["92", "95", "98"],
            "Объем, л": ["1", "10", "20"]
        }
    },
    "Бензонасос": {
        "brands": ["Bosch", "OEM"],
        "models": ["Газ 3302", "3110 дв. 406"],
        "attributes": {
            "Вид продукции": "Бензонасос",
            "Модель автомобиля": ["Газ 3302", "УАЗ"],
            "Тип": ["Электрический", "Механический"]
        }
    },
    "Бензопила": {
        "brands": ["Makita", "Stihl", "Husqvarna"],
        "models": ["MS 211", "MS 250", "435"],
        "attributes": {
            "Вид продукции": "Бензопила",
            "Длина шины, см": ["20", "35", "40"],
            "Мощность, кВт": ["1.5", "2.0", "2.5"]
        }
    },
    "Вал": {
        "brands": ["ЗМЗ", "OEM"],
        "models": ["Промежуточный 40", "Распределительный 26015"],
        "attributes": {
            "Вид продукции": "Вал",
            "Тип": ["Промежуточный", "Распределительный", "Рулевого управления"]
        }
    },
    "Веб-камера": {
        "brands": ["Exegate", "Canon", "Logitech"],
        "models": ["EX2854566182RUS", "Full-HD 1080P", "C920"],
        "attributes": {
            "Вид продукции": "Веб-камера",
            "Разрешение": ["720p", "1080p", "4K"]
        }
    },
    "Ведро": {
        "brands": ["OEM"],
        "models": ["Пожарное конусное", "Эмалированное 10 л"],
        "attributes": {
            "Вид продукции": "Ведро",
            "Объем, л": ["10", "15", "20"],
            "Материал": ["Пластик", "Металл"]
        }
    },
    "Вентиль": {
        "brands": ["OEM"],
        "models": ["ВПЭМ 5х35 ХЛ", "1/2-В М20х1,5-В"],
        "attributes": {
            "Вид продукции": "Вентиль",
            "Диаметр, дюйм": ["1/2", "3/4"]
        }
    },
    "Диск": {
        "brands": ["Seagate", "Western Digital", "OEM"],
        "models": ["Внешний SSD 1Tb", "Жесткий 1.0 Tb", "Жесткий 2.5\" 1Tb"],
        "attributes": {
            "Вид продукции": "Диск",
            "Тип": ["SSD", "HDD"],
            "Объем": ["1 Tb", "2 Tb", "8 Tb"]
        }
    },
    "Домкрат": {
        "brands": ["OEM", "Stayer"],
        "models": ["Гидравлический 16т", "Бутылочный 16т"],
        "attributes": {
            "Вид продукции": "Домкрат",
            "Грузоподъемность, т": ["16"]
        }
    },
    "Дрель-шуруповерт": {
        "brands": ["Bosch", "Makita", "DeWalt"],
        "models": ["GSR 18-2", "DTW190RME", "DTGFIW1900RME"],
        "attributes": {
            "Вид продукции": "Дрель-шуруповерт",
            "Тип": ["Аккумуляторный", "Сетевой"],
            "Модель": None
        }
    },
    "Жидкость": {
        "brands": ["ЕКVR", "OEM"],
        "models": ["Незамерзающая -80С", "Смазочно-охлаждающая ЭКОЛ-3М"],
        "attributes": {
            "Вид продукции": "Жидкость",
            "Тип": ["Незамерзающая", "Тормозная", "Смазочная"],
            "Объем, мл": ["2000", "500"]
        }
    },
    "Задвижка": {
        "brands": ["OEM"],
        "models": ["Ду100 Ру18 50лс41нж", "Ду100 Ру14 УХЛ с КОФ"],
        "attributes": {
            "Вид продукции": "Задвижка",
            "Диаметр, мм": ["100"],
            "Давление, Ру": ["14", "18"]
        }
    },
    "Комбинезон": {
        "brands": ["OEM"],
        "models": ["Защита мех. воздействий", "Защита от токсичных веществ"],
        "attributes": {
            "Вид продукции": "Комбинезон",
            "Материал": ["Нетканный", "Полиэстер"],
            "Размер": ["104-108", "194-200"]
        }
    },
    "Коммутатор": {
        "brands": ["Hikvision", "OEM"],
        "models": ["DS-3E0109POE", "ICP-NS-205A"],
        "attributes": {
            "Вид продукции": "Коммутатор",
            "Порты": ["8", "12"],
            "Тип": ["Промышленный", "Офисный"]
        }
    },
    "Кондиционер": {
        "brands": ["Hitachi", "Mitsubishi", "LG"],
        "models": ["AN1", "SRK20ZJX", "MSZ-HJ25VA"],
        "attributes": {
            "Вид продукции": "Кондиционер",
            "Мощность, кВт": ["2", "2.5", "3.5"]
        }
    },
    "Кран": {
        "brands": ["OEM"],
        "models": ["Шаровый UGDF 50ФЦ", "ЯГТ 80ФТ.044.F.00.ХЛ"],
        "attributes": {
            "Вид продукции": "Кран",
            "Тип": ["Шаровый"],
            "Диаметр, мм": ["50", "80"]
        }
    },
    "Краска": {
        "brands": ["OEM"],
        "models": ["Алкидная по металлу черная", "Водоэмульсионная ВД-АК-24"],
        "attributes": {
            "Вид продукции": "Краска",
            "Тип": ["Алкидная", "Водоэмульсионная"],
            "Объем, кг": ["3.5"]
        }
    },
    "Крупа": {
        "brands": ["OEM"],
        "models": ["Пшеничная"],
        "attributes": {
            "Вид продукции": "Крупа",
            "Вес, кг": ["4"]
        }
    },
    "Крышка": {
        "brands": ["YAMAHA", "OEM"],
        "models": ["5YRD2-2628Н", "Клапанная 4 ступ"],
        "attributes": {
            "Вид продукции": "Крышка",
            "Тип": ["Мотора", "Клапанная"]
        }
    },

    "Костюм защитный": {
        "brands": ["Ток 200", "Транском", "SafePro"],
        "models": ["Ток 200", "00 со вшитыми сапогами", "ZuTFGHVERA-пылезащита"],
        "attributes": {
            "Вид продукции": "Костюм защитный",
            "Материал": ["Нетканный", "Полиэстер"],
            "Размер": ["L", "XL", "XXL"]
        }
    },
    "Котел": {
        "brands": ["LoUGFDgano", "Vaillant", "Bosch"],
        "models": ["G124 WS-32", "EcoTec Plus"],
        "attributes": {
            "Вид продукции": "Котел",
            "Мощность, кВт": ["32", "24", "40"]
        }
    },
    "Кран шаровый": {
        "brands": ["UGDF", "ЯГТ", "Valtec"],
        "models": ["50ФЦ.063.J.00.ХЛ", "80ФТ.044.F.00.ХЛ", "80ФЦ.100 ХЛ"],
        "attributes": {
            "Вид продукции": "Кран шаровый",
            "Диаметр, мм": ["50", "80", "100"],
            "Материал": ["Сталь", "Латунь"]
        }
    },
    "Краска алкидная": {
        "brands": ["Sniezka", "Tikkurila", "Caparol"],
        "models": ["По металлу черная", "Красная", "По металлу"],
        "attributes": {
            "Вид продукции": "Краска алкидная",
            "Цвет": ["Черный", "Красный", "Белый"],
            "Объем": ["3.5 кг", "5 кг"]
        }
    },
    "Кувалда": {
        "brands": ["OEM", "Stayer", "Matrix"],
        "models": ["12 кг", "14 кг"],
        "attributes": {
            "Вид продукции": "Кувалда",
            "Вес, кг": ["12", "14"]
        }
    },
    "Куртка рабочая": {
        "brands": ["Sofell", "Carhartt", "Dickies"],
        "models": ["С капюшоном", "Без капюшона"],
        "attributes": {
            "Вид продукции": "Куртка рабочая",
            "Материал": ["Хлопок", "Полиэстер"],
            "Размер": ["M", "L", "XL"]
        }
    },
    "Лампа": {
        "brands": ["ВОСХОД", "Philips", "Osram"],
        "models": ["12V-5 ВА15s", "LED E27", "Галогенная"],
        "attributes": {
            "Вид продукции": "Лампа",
            "Напряжение": ["12V", "220V"],
            "Тип цоколя": ["ВА15s", "E27"]
        }
    },
    "Лампа светодиодная": {
        "brands": ["Philips", "Osram", "General Electric"],
        "models": ["LED 9W", "LED 12W", "LED 15W"],
        "attributes": {
            "Вид продукции": "Лампа светодиодная",
            "Мощность, Вт": ["9", "12", "15"],
            "Цвет свечения": ["Теплый", "Холодный", "Нейтральный"]
        }
    },
    "Маска защитная": {
        "brands": ["3M", "Honeywell", "OEM"],
        "models": ["FFP2", "FFP3", "Surgical"],
        "attributes": {
            "Вид продукции": "Маска защитная",
            "Тип": ["Респиратор", "Медицинская"],
            "Размер": ["S", "M", "L"]
        }
    },
    "Моторное масло": {
        "brands": ["LUKOIL", "Mobil", "Shell"],
        "models": ["5W-40", "10W-40", "0W-20"],
        "attributes": {
            "Вид продукции": "Моторное масло",
            "Вязкость": ["5W-40", "10W-40", "0W-20"],
            "Объем, л": ["1", "4", "5"]
        }
    },
    "Насос": {
        "brands": ["Grundfos", "Pedrollo", "Koshin"],
        "models": ["NK 210", "BP 4-35", "SEV 50"],
        "attributes": {
            "Вид продукции": "Насос",
            "Мощность, Вт": ["150", "200", "300"],
            "Тип": ["Погружной", "Поверхностный"]
        }
    },
    "Отвертка": {
        "brands": ["Wiha", "Kraftool", "Stanley"],
        "models": ["SL6x100", "PH2x150", "Torx T20"],
        "attributes": {
            "Вид продукции": "Отвертка",
            "Тип": ["Шлицевая", "Крестовая", "Torx"],
            "Длина, мм": ["100", "150"]
        }
    },
    "Паяльник": {
        "brands": ["Ersa", "Hakko", "Atten"],
        "models": ["ESD 80W", "FX-888D", "AT8586D"],
        "attributes": {
            "Вид продукции": "Паяльник",
            "Мощность, Вт": ["60", "80", "100"]
        }
    },
    "Пила дисковая": {
        "brands": ["Makita", "DeWalt", "Bosch"],
        "models": ["HS7601", "DWE575", "GKS190"],
        "attributes": {
            "Вид продукции": "Пила дисковая",
            "Мощность, Вт": ["1400", "1600", "1800"],
            "Диаметр диска, мм": ["190", "185", "210"]
        }
    },
    "Плитка керамическая": {
        "brands": ["Kerama Marazzi", "Cersanit", "Estima"],
        "models": ["Белая глянцевая", "Серая матовая"],
        "attributes": {
            "Вид продукции": "Плитка керамическая",
            "Размер, мм": ["300x300", "600x600", "400x400"],
            "Толщина, мм": ["8", "10"]
        }
    },
    "Пневмоинструмент": {
        "brands": ["Ingersoll Rand", "Atlas Copco", "Chicago Pneumatic"],
        "models": ["IR-2135", "CP-7748", "AC-1200"],
        "attributes": {
            "Вид продукции": "Пневмоинструмент",
            "Тип": ["Гайковерт", "Шлифмашина", "Дрель"]
        }
    },
    "Подшипник": {
        "brands": ["SKF", "NSK", "FAG"],
        "models": ["6205", "6306", "6310"],
        "attributes": {
            "Вид продукции": "Подшипник",
            "Тип": ["Радиальный", "Упорный"],
            "Размер": ["25x52x15", "30x62x16"]
        }
    },
    "Проволока сварочная": {
        "brands": ["ESAB", "Lincoln Electric", "OEM"],
        "models": ["ER70S-6", "E71T-GS"],
        "attributes": {
            "Вид продукции": "Проволока сварочная",
            "Диаметр, мм": ["0.8", "1.0", "1.2"],
            "Материал": ["Сталь", "Нержавеющая сталь"]
        }
    },
    "Резиновый шланг": {
        "brands": ["Karcher", "OEM"],
        "models": ["1/2\"", "3/4\""],
        "attributes": {
            "Вид продукции": "Резиновый шланг",
            "Диаметр": ["12 мм", "19 мм"],
            "Длина, м": ["5", "10"]
        }
    },
    "Рулетка": {
        "brands": ["Stanley", "Bosch", "Hultafors"],
        "models": ["5 м", "7.5 м", "10 м"],
        "attributes": {
            "Вид продукции": "Рулетка",
            "Длина, м": ["5", "7.5", "10"]
        }
    },
    "Сварочный аппарат": {
        "brands": ["Fronius", "Lincoln Electric", "Telwin"],
        "models": ["TPS 270i", "Power MIG 210", "Technomig 215"],
        "attributes": {
            "Вид продукции": "Сварочный аппарат",
            "Тип": ["MIG/MAG", "TIG", "MMA"],
            "Мощность, кВт": ["6", "8", "10"]
        }
    },
    "Светильник": {
        "brands": ["Philips", "Osram", "General Electric"],
        "models": ["LED Panel", "Spotlight", "Floodlight"],
        "attributes": {
            "Вид продукции": "Светильник",
            "Мощность, Вт": ["10", "20", "30"],
            "Цвет свечения": ["Теплый", "Холодный"]
        }
    },
    "Смеситель": {
        "brands": ["Grohe", "Hansgrohe", "Cersanit"],
        "models": ["Eurostyle", "Focus", "Talis"],
        "attributes": {
            "Вид продукции": "Смеситель",
            "Тип": ["Кухонный", "Ванная"],
            "Материал": ["Латунь", "Нержавеющая сталь"]
        }
    },
    "Спецодежда": {
        "brands": ["SafePro", "Redkap", "Cerva"],
        "models": ["Костюм", "Куртка", "Штаны"],
        "attributes": {
            "Вид продукции": "Спецодежда",
            "Материал": ["Хлопок", "Полиэстер"],
            "Размер": ["M", "L", "XL"]
        }
    },
    "Строительный уровень": {
        "brands": ["Stabila", "Bosch", "Kapro"],
        "models": ["Type 196", "GCL 2-50", "98-1-24"],
        "attributes": {
            "Вид продукции": "Строительный уровень",
            "Длина, см": ["60", "80", "120"]
        }
    },
    "Таль": {
        "brands": ["Demag", "Kito", "Yale"],
        "models": ["HSZ", "KS", "CXT"],
        "attributes": {
            "Вид продукции": "Таль",
            "Грузоподъемность, т": ["1", "2", "5"]
        }
    },
    "Тепловентилятор": {
        "brands": ["Ballu", "Electrolux", "Timberk"],
        "models": ["BFH/S-02", "EFH/W-2000", "TFH 15 E"],
        "attributes": {
            "Вид продукции": "Тепловентилятор",
            "Мощность, Вт": ["1500", "2000", "2500"]
        }
    },
    "Термометр": {
        "brands": ["Testo", "Fluke", "Extech"],
        "models": ["Testo 925", "Fluke 62 Max", "Extech 42550"],
        "attributes": {
            "Вид продукции": "Термометр",
            "Тип": ["Инфракрасный", "Цифровой"]
        }
    },
    "Топливо дизельное": {
        "brands": ["Shell", "LUKOIL", "Gazpromneft"],
        "models": ["ДТ Зимнее", "ДТ Летнее"],
        "attributes": {
            "Вид продукции": "Топливо дизельное",
            "Тип": ["Зимнее", "Летнее"],
            "Объем, литр": ["10", "20"]
        }
    },
    "Трос стальной": {
        "brands": ["Prysmian", "Bridon", "Crosby"],
        "models": ["DIN 3060", "EN 12385"],
        "attributes": {
            "Вид продукции": "Трос стальной",
            "Диаметр, мм": ["6", "8", "10"],
            "Длина, м": ["10", "20", "50"]
        }
    },
    "Удлинитель": {
        "brands": ["Brennenstuhl", "Legrand", "Xiaomi"],
        "models": ["3 розетки", "5 розеток", "7 розеток"],
        "attributes": {
            "Вид продукции": "Удлинитель",
            "Длина кабеля, м": ["3", "5", "10"]
        }
    },
    "Фен строительный": {
        "brands": ["Bosch", "Makita", "DeWalt"],
        "models": ["GHG 20-63", "HG6530VK", "D26411"],
        "attributes": {
            "Вид продукции": "Фен строительный",
            "Мощность, Вт": ["2000", "2300", "1800"]
        }
    },
    "Фильтр воздушный": {
        "brands": ["Mann", "Bosch", "OEM"],
        "models": ["C 25 136", "1 457 433 017"],
        "attributes": {
            "Вид продукции": "Фильтр воздушный",
            "Тип": ["Сменный", "Постоянный"]
        }
    },
    "Фильтр масляный": {
        "brands": ["Mann", "Bosch", "OEM"],
        "models": ["W 719/30", "OX 188"],
        "attributes": {
            "Вид продукции": "Фильтр масляный",
            "Тип": ["Сменный", "Постоянный"]
        }
    },
    "Фильтр топливный": {
        "brands": ["Mann", "Bosch", "OEM"],
        "models": ["WK 842/21", "P550153"],
        "attributes": {
            "Вид продукции": "Фильтр топливный",
            "Тип": ["Сменный", "Постоянный"]
        }
    },
    "Шланг для полива": {
        "brands": ["Gardena", "Karcher", "OEM"],
        "models": ["19 мм", "25 мм"],
        "attributes": {
            "Вид продукции": "Шланг для полива",
            "Длина, м": ["10", "20", "30"]
        }
    },
    "Шуруп": {
        "brands": ["OEM", "Kraftool", "Stayer"],
        "models": ["5x50", "6x70", "4x30"],
        "attributes": {
            "Вид продукции": "Шуруп",
            "Размер": ["5x50", "6x70", "4x30"],
            "Материал": ["Сталь", "Нержавеющая сталь"]
        }
    },
    "Электрод": {
        "brands": ["ESAB", "Lincoln Electric", "OEM"],
        "models": ["E7018", "E6013"],
        "attributes": {
            "Вид продукции": "Электрод",
            "Диаметр, мм": ["3", "4", "5"],
            "Длина, мм": ["350", "400"]
        }
    },
    "Балка": {
        "brands": ["С345", "СтальПром", "МеталлИнвест"],
        "models": ["Б35-2-16 с.3.407.9-146", "Б40-3-20 с.3.407.9-150"],
        "attributes": {
            "Вид продукции": "Балка",
            "Марка стали": ["С345", "Ст3", "09Г2С"],
            "Длина, м": ["6", "12", "24"]
        }
    },
    "Бензин": {
        "brands": ["Регуляр", "Премиум", "Экто"],
        "models": ["АИ-92-К5", "АИ-95", "АИ-98"],
        "attributes": {
            "Вид продукции": "Бензин",
            "Марка": ["92", "95", "98"],
            "Тип": ["Регуляр", "Премиум"],
            "Объем, литр": ["1", "5", "10"]
        }
    },
    "Бензонасос": {
        "brands": ["Газ", "Bosch", "Delphi"],
        "models": ["3302; 3110 дв. 406", "0580464038", "DS-101"],
        "attributes": {
            "Вид продукции": "Бензонасос",
            "Бренд": None,
            "Модель": None,
            "Тип": ["Электрический", "Механический"]
        }
    },
    "Бензопила": {
        "brands": ["Makita", "Stihl", "Husqvarna"],
        "models": ["MS 211", "MS 250", "T535 XP"],
        "attributes": {
            "Вид продукции": "Бензопила",
            "Бренд": None,
            "Модель": None,
            "Длина шины, см": ["20", "35", "40"]
        }
    },
    "Втулка цилиндровая": {
        "brands": ["OEM", "Bosch", "Luk"],
        "models": ["ф120", "ф-135", "ф100"],
        "attributes": {
            "Вид продукции": "Втулка цилиндровая",
            "Диаметр, мм": ["120", "135", "100"]
        }
    },
    "Выключатель автоматический": {
        "brands": ["IEK", "Schneider Electric", "ABB"],
        "models": ["MC101A", "C-1 A 1M", "B16"],
        "attributes": {
            "Вид продукции": "Выключатель автоматический",
            "Номинальный ток, А": ["6", "10", "16"],
            "Количество полюсов": ["1", "2", "3"]
        }
    },
    "Гайка": {
        "brands": ["ГОСТ", "Sheider", "Bosch"],
        "models": ["М10", "М12", "М11"],
        "attributes": {
            "Вид продукции": "Гайка",
            "Размер": ["М10", "М12", "М11"],
            "Материал": ["Сталь", "Латунь"]
        }
    },
    "Гайковерт аккумуляторный": {
        "brands": ["Makita", "Bosch", "DeWalt"],
        "models": ["DTW190RME", "DTGFIW1900RME", "DCD791D2"],
        "attributes": {
            "Вид продукции": "Гайковерт аккумуляторный",
            "Бренд": None,
            "Модель": None,
            "Напряжение, В": ["18", "20", "12"]
        }
    },
    "Гарнитура": {
        "brands": ["Logitech", "Sony", "Sennheiser"],
        "models": ["H110 Stereo", "WH-1000XM4", "HD 280 Pro"],
        "attributes": {
            "Вид продукции": "Гарнитура",
            "Тип": ["Стерео", "Моно"],
            "Подключение": ["Проводная", "Беспроводная"]
        }
    },
    "Блок питания": {
        "brands": ["Cisco", "Mean Well", "Delta"],
        "models": ["AC Power 1025745841", "LRS-350-12", "DRP-24-24"],
        "attributes": {
            "Вид продукции": "Блок питания",
            "Выходное напряжение": ["12 V", "24 V", "48 V"],
            "Мощность, Вт": ["100", "350", "500"]
        }
    },
    "Блок шестеренок": {
        "brands": ["ГАЗ", "OEM"],
        "models": ["ГАЗ-53 с/о", "Model X"],
        "attributes": {
            "Вид продукции": "Блок шестеренок",
            "Материал": ["Сталь", "Чугун"]
        }
    },
    "Болторез": {
        "brands": ["Matrix", "Tolsen", "Stayer"],
        "models": ["900 мм", "600 мм", "450 мм"],
        "attributes": {
            "Вид продукции": "Болторез",
            "Длина, мм": ["900", "600", "450"]
        }
    },
    "Ботинки кожаные": {
        "brands": ["Franchesco", "Timberland", "Caterpillar"],
        "models": ["р.35", "р.38", "р.40"],
        "attributes": {
            "Вид продукции": "Ботинки кожаные",
            "Размер": ["35", "38", "40"],
            "Материал": ["Кожа натуральная", "Кожа искусственная"]
        }
    },
    "Боты диэлектрические": {
        "brands": ["ТУ 38", "SafePro"],
        "models": ["106645465564-96", "14605-96"],
        "attributes": {
            "Вид продукции": "Боты диэлектрические",
            "Номер ТУ": ["106645465564-96", "14605-96"],
            "Размер": ["40", "42", "44"]
        }
    },
    "Вал рулевого управления": {
        "brands": ["ГАЗ", "OEM"],
        "models": ["3307-3401044-10", "Model Y"],
        "attributes": {
            "Вид продукции": "Вал рулевого управления",
            "Материал": ["Сталь", "Алюминий"]
        }
    },
    "Вал стабилизатора": {
        "brands": ["ГАЗ", "OEM"],
        "models": ["6430-462906006", "5516-2916006"],
        "attributes": {
            "Вид продукции": "Вал стабилизатора",
            "Позиция": ["С кронштейнами", "С рычагами"]
        }
    },
    "Вал торсионный": {
        "brands": ["ГАЗ", "OEM"],
        "models": ["ГАЗ-71", "34039У-2946036-80"],
        "attributes": {
            "Вид продукции": "Вал торсионный",
            "Позиция": ["Левый", "Правый"]
        }
    },
    "Ведро": {
        "brands": ["OEM", "Steri"],
        "models": ["пожарное конусное", "эмалированное 10 л"],
        "attributes": {
            "Вид продукции": "Ведро",
            "Объем": ["10 л", "12 л"],
            "Тип": ["Пожарное", "Обычное"]
        }
    },
    "Задвижка": {
        "brands": ["КЗТА", "OEM"],
        "models": ["Ду100 Ру18 50лс41нж", "Ду100 Ру14 УХЛ с КОФ"],
        "attributes": {
            "Вид продукции": "Задвижка",
            "Диаметр, мм": ["100", "150"],
            "Рабочее давление": ["18", "14"]
        }
    },
    "Коммутатор": {
        "brands": ["Hikvision", "Cisco", "TP-Link"],
        "models": ["DS-3E0109POE", "121545551.370548", "DSPO-3E0105P-E"],
        "attributes": {
            "Вид продукции": "Коммутатор",
            "Порты": ["8", "12", "24"],
            "Тип": ["Промышленный", "Офисный"]
        }
    },
    "Кондиционер": {
        "brands": ["Hitachi", "Mitsubishi", "LG"],
        "models": ["AN1 2 КВт", "MSZ-AP25VG", "ArtCool"],
        "attributes": {
            "Вид продукции": "Кондиционер",
            "Мощность": ["2 КВт", "3.5 КВт", "5 КВт"],
            "Тип": ["Настенный", "Мобильный"]
        }
    },
    "Кран шаровый": {
        "brands": ["UGDF", "ЯГТ", "Valtec"],
        "models": ["50ФЦ.063.J.00.ХЛ", "80ФТ.044.F.00.ХЛ", "80ФЦ.100 ХЛ"],
        "attributes": {
            "Вид продукции": "Кран шаровый",
            "Диаметр": ["50", "80", "100"],
            "Материал": ["Сталь", "Латунь"]
        }
    },
    "Краска водоэмульсионная": {
        "brands": ["Sniezka", "Tikkurila", "Caparol"],
        "models": ["ВД-АК-24 черная", "ВД-АК-225 влагостойкая"],
        "attributes": {
            "Вид продукции": "Краска водоэмульсионная",
            "Цвет": ["Черная", "Белая", "Серая"],
            "Объем": ["3.5 кг", "5 кг"]
        }
    },
    "Крупа пшеничная": {
        "brands": ["РосАгро", "Черкизово", "Экстра"],
        "models": ["4 кг", "1 кг", "2 кг"],
        "attributes": {
            "Вид продукции": "Крупа пшеничная",
            "Вес": ["1 кг", "2 кг", "4 кг"],
            "Качество": ["Экстра", "Первый сорт"]
        }
    },
    "Лампа": {
        "brands": ["ВОСХОД", "Philips", "Osram"],
        "models": ["12V-5 ВА15s", "LED E27", "Галогенная"],
        "attributes": {
            "Вид продукции": "Лампа",
            "Напряжение": ["12V", "220V"],
            "Тип цоколя": ["ВА15s", "E27"]
        }
    },
    "Желатин": {
        "brands": ["Dr.Oetker", "Royal", "OEM"],
        "models": ["100 г", "50 г"],
        "attributes": {
            "Вид продукции": "Желатин",
            "Вес": ["50 г", "100 г"]
        }
    },
    "Жидкость смазочно-охлаждающая": {
        "brands": ["ЭКОЛ-3М", "LUKOIL", "Castrol"],
        "models": ["ТУ 0285-025-23763315-2005"],
        "attributes": {
            "Вид продукции": "Жидкость смазочно-охлаждающая",
            "Объем": ["1 л", "5 л"]
        }
    },
    "Заглушка фланцевая": {
        "brands": ["OEM", "Stainless"],
        "models": ["2-5600-0,6", "3-200-16", "1-200-16"],
        "attributes": {
            "Вид продукции": "Заглушка фланцевая",
            "Материал": ["Сталь 09Г2С", "Нержавеющая сталь"],
            "Диаметр, мм": ["200", "5600"]
        }
    },
    "Генератор": {
        "brands": ["УАЗ", "Bosch", "Honda"],
        "models": ["32126554М.3771000 14В/60А УАЗ", "Bosch G5000", "Honda EU22i"],
        "attributes": {
            "Вид продукции": "Генератор",
            "Модель": None,
            "Напряжение": ["14В", "12В", "24В"],
            "Ток, А": ["60", "75", "90"]
        }
    },
    "Диск жесткий": {
        "brands": ["Seagate", "Western Digital", "HP"],
        "models": ["1.0 Tb", "2.5\"", "8 ТБ WD Red Pro"],
        "attributes": {
            "Вид продукции": "Диск жесткий",
            "Бренд": None,
            "Объем": ["1.0 Tb", "2 Тб", "8 Тб"],
            "Форм-фактор": ["2.5\"", "3.5\""]
        }
    },
    "Дрель-шуруповерт": {
        "brands": ["Bosch", "Makita", "DeWalt"],
        "models": ["GSR 18-2", "DTW190RME", "DTGFIW1900RME"],
        "attributes": {
            "Вид продукции": "Дрель-шуруповерт",
            "Бренд": None,
            "Модель": None,
            "Тип": ["Аккумуляторный", "Сетевой"]
        }
    },
    "IP-камера": {
        "brands": ["TRASHPIR", "Hikvision", "Dahua"],
        "models": ["TR-D2223W", "DS-2CD2142FWD-I", "IPC-HFW1230S"],
        "attributes": {
            "Вид продукции": "IP-камера",
            "Бренд": None,
            "Модель": None,
            "Разрешение": ["2MP", "4MP", "8MP"],
            "Тип корпуса": ["Промышленная", "Ударопрочная", "Вандалозащищённая"]
        }
    },
    "Автошина": {
        "brands": ["Kama", "Dunlop", "Michelin"],
        "models": ["420х85R21-146J", "285/60R18", "11,00R24"],
        "attributes": {
            "Вид продукции": "Автошина",
            "Бренд": None,
            "Размер": ["11,00R24", "285/60R18", "9,25R22"],
            "Тип": ["Всесезонная", "Зимняя", "Летняя"]
        }
    },
    "Аккумулятор": {
        "brands": ["Tumen", "Bosch", "Varta"],
        "models": ["11В 2,2А/час", "12В 26А/ч", "60Ah"],
        "attributes": {
            "Вид продукции": "Аккумулятор",
            "Бренд": None,
            "Емкость, Ач": ["2.2", "26", "60"],
            "Тип": ["Герметичный свинцово-кислотный", "Литий-ионный"]
        }
    },
    "Антифриз": {
        "brands": ["LUKOIL", "SAKURA", "G-12"],
        "models": ["G11-40 RED", "RED", "G-12/-40"],
        "attributes": {
            "Вид продукции": "Антифриз",
            "Бренд": None,
            "Объем": ["3 л", "5 л", "10 л"],
            "Цвет": ["Красный", "Синий", "Зеленый"]
        }
    },
    "Аппарат электромагнитный": {
        "brands": ["ПРА", "Siemens", "ABB"],
        "models": ["IP20 УХЛ2", "УХЛ1", "Модель X"],
        "attributes": {
            "Вид продукции": "Аппарат электромагнитный",
            "Бренд": None,
            "Тип": ["Пускорегулирующий", "Защитный"]
        }
    },
    "Амортизатор": {
        "brands": ["Monroe", "KYB", "Gaz"],
        "models": ["53212", "630300-1001029", "ГАЗ-33081"],
        "attributes": {
            "Вид продукции": "Амортизатор",
            "Бренд": None,
            "Модель": None,
            "Тип": ["Передний", "Задний"]
        }
    },
    "Балансир": {
        "brands": ["УАЗ", "ГАЗ"],
        "models": ["71-2946011-10", "71-2946010-10", "34040"],
        "attributes": {
            "Вид продукции": "Балансир",
            "Бренд": None,
            "Позиция": ["Правый передний", "Средний каток", "Первого катка"]
        }
    },
    "Болт": {
        "brands": ["ГОСТ", "Sheider", "Bosch"],
        "models": ["М16x35", "М22х1,5", "М14х1,5х75"],
        "attributes": {
            "Вид продукции": "Болт",
            "Бренд": None,
            "Размер": ["12х110", "М16х35", "М22х1,5"],
            "Материал": ["Сталь", "Хром", "Нержавеющая"]
        }
    },
    "Брызговик": {
        "brands": ["ГАЗ", "УАЗ"],
        "models": ["3163-8546320-00", "3163-8404320-00"],
        "attributes": {
            "Вид продукции": "Брызговик",
            "Бренд": None,
            "Позиция": ["Передний", "Задний", "Правый"]
        }
    },
    "Веб-камера": {
        "brands": ["Exegate", "Canon", "Logitech"],
        "models": ["EX2854566182RUS", "Full-HD 1080P А4", "C920"],
        "attributes": {
            "Вид продукции": "Веб-камера",
            "Бренд": None,
            "Разрешение": ["720p", "1080p", "4K"],
            "Микрофон": ["Встроенный", "Нет"]
        }
    },
    "Вентиль": {
        "brands": ["ВПЭМ", "Honeywell", "Siemens"],
        "models": ["5х35 ХЛ", "10х50", "15х70"],
        "attributes": {
            "Вид продукции": "Вентиль",
            "Бренд": None,
            "Размер": ["1/2-В", "3/4-В", "1-В"],
            "Материал": ["Сталь", "Латунь"]
        }
    },
    "Домкрат гидравлический": {
        "brands": ["Force", "Hi-Lift", "Tamer"],
        "models": ["16т", "10т", "5т"],
        "attributes": {
            "Вид продукции": "Домкрат гидравлический",
            "Бренд": None,
            "Грузоподъемность": ["5т", "10т", "16т"]
        }
    },
    "Дюбель": {
        "brands": ["Fischer", "Hilti", "Tox"],
        "models": ["распорный", "металлический", "пластиковый"],
        "attributes": {
            "Вид продукции": "Дюбель",
            "Бренд": None,
            "Тип": ["распорный", "химический", "саморез"]
        }
    },
    "Жесткий диск": {
        "brands": ["Hikvision", "WD", "Seagate"],
        "models": ["T30 2T Black", "WD 2,5''", "Red Pro 8 ТБ"],
        "attributes": {
            "Вид продукции": "Жесткий диск",
            "Бренд": None,
            "Объем": ["2 Тб", "8 Тб", "500 Гб"],
            "Форм-фактор": ["2.5\"", "3.5\""]
        }
    },
    "Жидкость тормозная": {
        "brands": ["OUTED", "Castrol", "LUKOIL"],
        "models": ["Р-Синтез Class 6", "DOT-4", "DOT-5.1"],
        "attributes": {
            "Вид продукции": "Жидкость тормозная",
            "Бренд": None,
            "Объем": ["0.455л", "1л", "5л"],
            "Тип": ["DOT-4", "DOT-5.1"]
        }
    },
    "Кран шаровый": {
        "brands": ["ЯГТ", "UGDF", "Valtec"],
        "models": ["50ФЦ.063.J.00.ХЛ", "80ФТ.044.F.00.ХЛ", "80ФЦ.100 ХЛ"],
        "attributes": {
            "Вид продукции": "Кран шаровый",
            "Бренд": None,
            "Диаметр": ["50", "80", "100"],
            "Материал": ["Сталь", "Латунь"]
        }
    },
    "Комбинезон защитный": {
        "brands": ["ZuTFGHVERA", "Sofell", "Lukoil"],
        "models": ["Пылезащита 50 г/м2", "Ток 200", "Токсичные вещества"],
        "attributes": {
            "Вид продукции": "Комбинезон защитный",
            "Бренд": None,
            "Материал": ["Нетканный", "Хлопок"],
            "Размер": ["104-108", "194-200"]
        }
    },
    "Котел": {
        "brands": ["LoUGFDgano", "Baxi", "Ariston"],
        "models": ["G124 WS-32 КВт", "Eco 24", "Luna 3"],
        "attributes": {
            "Вид продукции": "Котел",
            "Бренд": None,
            "Мощность": ["24 КВт", "32 КВт", "18 КВт"]
        }
    },
    "Краска алкидная": {
        "brands": ["Sniezka", "Tikkurila", "Caparol"],
        "models": ["Черная", "Красная", "Белая"],
        "attributes": {
            "Вид продукции": "Краска алкидная",
            "Бренд": None,
            "Цвет": ["Черная", "Красная", "Белая"],
            "Объем": ["3.5 кг", "5 кг"]
        }
    },
    "Крышка клапанная": {
        "brands": ["Yamaha", "Honda", "Suzuki"],
        "models": ["5YRD2-2628Н", "Model X", "Model Y"],
        "attributes": {
            "Вид продукции": "Крышка клапанная",
            "Бренд": None,
            "Размер": ["4 ступ."]
        }
    },
    "Кувалда": {
        "brands": ["Stayer", "Tolsen", "Matrix"],
        "models": ["12 кг", "14 кг"],
        "attributes": {
            "Вид продукции": "Кувалда",
            "Бренд": None,
            "Вес": ["12 кг", "14 кг"]
        }
    },
    "Куртка рабочая": {
        "brands": ["Sofell", "Portwest", "Helly Hansen"],
        "models": ["С капюшоном", "Зимняя", "Летняя"],
        "attributes": {
            "Вид продукции": "Куртка рабочая",
            "Бренд": None,
            "Размер": ["M", "L", "XL"]
        }
    }
}

def generate_product(product_key, product_info):
    brand = random.choice(product_info.get("brands", ["Неизвестно"]))
    model = random.choice(product_info.get("models", ["Неизвестно"]))
    attributes = {}
    for attr, vals in product_info.get("attributes", {}).items():
        if isinstance(vals, list):
            attributes[attr] = random.choice(vals)
        else:
            attributes[attr] = vals
    product = {
        "Тип товара": product_key,
        "Бренд": brand,
        "Модель": model,
        "Атрибуты": attributes
    }
    return product

def product_to_text(product):
    parts = [product["Тип товара"], product["Бренд"], product["Модель"]]
    for attr, val in product["Атрибуты"].items():
        if attr != "Вид продукции":
            parts.append(str(val))
    return " ".join(filter(None, parts))

def generate_reference_template(catalog):
    template = {}
    for product_key, product_info in catalog.items():
        template[product_key] = {
            "Бренд": product_info.get("brands", []),
            "Модель": product_info.get("models", []),
            "Атрибуты": {}
        }
        for attr, vals in product_info.get("attributes", {}).items():
            if isinstance(vals, list):
                template[product_key]["Атрибуты"][attr] = vals
            else:
                template[product_key]["Атрибуты"][attr] = [vals]
    return template

def main():
    N = 100
    generated_products = []

    product_keys = list(products_catalog.keys())
    os.makedirs("data", exist_ok=True)

    with open("data/test_dataset.csv", "w", encoding="utf-8", newline="") as csvfile:
        fieldnames = ["raw_text", "expected_attrs"]
        writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
        writer.writeheader()

        for _ in range(N):
            product_key = random.choice(product_keys)
            product_info = products_catalog[product_key]
            product = generate_product(product_key, product_info)
            raw_text = product_to_text(product)
            # Вот здесь сериализуем атрибуты в JSON строку корректно
            expected_attrs = json.dumps(product["Атрибуты"], ensure_ascii=False)
            writer.writerow({"raw_text": raw_text, "expected_attrs": expected_attrs})

    print("Генерация завершена. Файл 'data/test_dataset.csv' создан.")

if __name__ == "__main__":
    main()